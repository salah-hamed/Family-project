<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ÙƒÙˆØ±Ø³ Family Business - Copy-Paste Method</title>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', Tahoma, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; color: #333; }
    .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
    .loading { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; justify-content: center; align-items: center; color: white; font-size: 24px; z-index: 999; }
    .lesson { display: none; animation: fadeIn 0.5s; }
    .lesson.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .nav-btn { background: #4CAF50; color: white; border: none; padding: 15px 30px; margin: 10px; border-radius: 50px; font-size: 18px; cursor: pointer; }
    .progress { width: 100%; height: 10px; background: #ddd; border-radius: 5px; margin: 20px 0; }
    .progress-bar { height: 100%; background: linear-gradient(90deg, #4CAF50, #45a049); border-radius: 5px; transition: width 0.3s; }
    .code-block { background: #f4f4f4; padding: 20px; border-radius: 10px; overflow-x: auto; direction: ltr; }
    button:hover { transform: scale(1.05); }
    @media (max-width: 768px) { .nav-btn { padding: 12px 24px; font-size: 16px; } }
  </style>
</head>
<body>
  <div id="loading" class="loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ÙƒÙˆØ±Ø³...</div>
  <div id="main" class="container" style="display:none;">
    <h1>ğŸ“ ÙƒÙˆØ±Ø³ Family Business - Ø¨Ù†Ø§Ø¡ e-commerce + Delivery ÙÙŠ Ø³Ø§Ø¹Ø§Øª</h1>
    <div class="progress">
      <div id="progressBar" class="progress-bar" style="width:0%"></div>
    </div>
    <div id="lessonContent"></div>
    <div style="text-align:center;">
      <button id="prevBtn" class="nav-btn" onclick="changeLesson(-1)">Ø§Ù„Ø¯Ø±Ø³ Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
      <button id="nextBtn" class="nav-btn" onclick="changeLesson(1)">Ø§Ù„Ø¯Ø±Ø³ Ø§Ù„ØªØ§Ù„ÙŠ</button>
      <button id="certBtn" class="nav-btn" style="background:#2196F3;" onclick="generateCert()">Ø´Ù‡Ø§Ø¯Ø© PDF</button>
    </div>
    <button onclick="logout()" style="background:#f44336;color:white;border:none;padding:10px 20px;border-radius:20px;margin-top:20px;">Ø®Ø±ÙˆØ¬</button>
  </div>

  <script>
    // Firebase Config Ø§Ù„Ø­Ø§Ù„ÙŠ
    const firebaseConfig = {
      apiKey: "AIzaSyB...YOUR_API_KEY...", // Ø¶Ø¹ config Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ù‡Ù†Ø§ Ù…Ù† kidsup-e998d
      authDomain: "kidsup-e998d.firebaseapp.com",
      projectId: "kidsup-e998d",
      storageBucket: "kidsup-e998d.appspot.com",
      messagingSenderId: "959800471628",
      appId: "1:959800471628:web:YOUR_APP_ID"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    let currentLesson = 0;
    let lessons = [
      { title: "1. Ù…Ù‚Ø¯Ù…Ø© Ùˆ Preview", content: "<p>Family Business: e-commerce Ù…Ø¹ client (ÙŠØ´ØªØ±ÙŠ)ØŒ merchant (ÙŠØ¨ÙŠØ¹)ØŒ delivery (ÙŠØ³Ù„Ù…). <a href='https://salahhamed.github.io/family-project/' target='_blank'>Ø´ÙˆÙ Preview</a></p>" },
      { title: "2. OneCompiler Ø£ÙˆÙ„ ØµÙØ­Ø©", content: "<p>Ø±ÙˆØ­ <a href='https://onecompiler.com/html' target='_blank'>OneCompiler</a>ØŒ ØµÙ‚ Ø§Ù„ÙƒÙˆØ¯ Ø¯Ù‡:</p><pre class='code-block'>// HTML ØªØ³Ø¬ÙŠÙ„ Ø¨Ø³ÙŠØ·</pre>" },
      // Ø£Ø¶Ù Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¯Ø±ÙˆØ³ Ù‡Ù†Ø§ Ø¨Ù†ÙØ³ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© - 10 Ø¯Ø±ÙˆØ³ ÙƒØ§Ù…Ù„Ø© Ù…Ø¹ ÙƒÙˆØ¯ + Ù„ÙŠÙ†ÙƒØ§Øª [web:19]
      { title: "10. Deploy + Ø´Ù‡Ø§Ø¯Ø©", content: "<p>Ø±ÙØ¹ Ø¹Ù„Ù‰ GitHub PagesØŒ Ø®Ø¯ Ø´Ù‡Ø§Ø¯ØªÙƒ! ğŸ‰</p>" }
    ];

    function initApp() {
      auth.onAuthStateChanged(async (user) => {
        if (user) {
          const doc = await db.collection('users').doc(user.uid).get();
          if (doc.exists && doc.data().courseActive) {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('main').style.display = 'block';
            loadProgress();
            showLesson();
          } else {
            alert('ÙØ¹Ù‘Ù„ Ø§Ù„ÙƒÙˆØ±Ø³ Ù…Ù† Ø§Ù„Ø£Ø¯Ù…Ù† Ø£ÙˆÙ„Ø§Ù‹.');
          }
        } else {
          window.location.href = 'index.html'; // ØµÙØ­Ø© login
        }
      });
    }

    function showLesson() {
      document.getElementById('lessonContent').innerHTML = lessons[currentLesson].content;
      document.getElementById('prevBtn').style.display = currentLesson > 0 ? 'inline' : 'none';
      document.getElementById('nextBtn').style.display = currentLesson < lessons.length - 1 ? 'inline' : 'none';
      document.getElementById('certBtn').style.display = currentLesson === lessons.length - 1 ? 'inline' : 'none';
      updateProgress();
    }

    function changeLesson(dir) {
      currentLesson += dir;
      saveProgress();
      showLesson();
    }

    function saveProgress() {
      auth.onAuthStateChanged((user) => {
        if (user) db.collection('users').doc(user.uid).update({ currentLesson });
      });
      localStorage.setItem('currentLesson', currentLesson);
    }

    function loadProgress() {
      currentLesson = parseInt(localStorage.getItem('currentLesson') || '0');
      auth.onAuthStateChanged(async (user) => {
        if (user) {
          const doc = await db.collection('users').doc(user.uid).get();
          if (doc.exists) currentLesson = doc.data().currentLesson || 0;
        }
      });
    }

    function updateProgress() {
      const progress = ((currentLesson + 1) / lessons.length) * 100;
      document.getElementById('progressBar').style.width = progress + '%';
    }

    function generateCert() {
      if (currentLesson === lessons.length - 1) {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        doc.text('Ø´Ù‡Ø§Ø¯Ø© Ø¥ÙƒÙ…Ø§Ù„ ÙƒÙˆØ±Ø³ Family Business', 105, 105, { angle: 0 });
        doc.save('certificate.pdf');
        alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©! ğŸ‰');
      }
    }

    function logout() {
      auth.signOut();
    }

    // Demo mode Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±
    if (location.search.includes('demo=1')) {
      document.getElementById('loading').style.display = 'none';
      document.getElementById('main').style.display = 'block';
    }

    initApp();
  </script>
</body>
</html>
